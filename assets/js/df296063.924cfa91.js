"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2842],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),g=a,h=d["".concat(s,".").concat(g)]||d[g]||u[g]||r;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6030:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=n(7462),a=(n(7294),n(3905));const r={},i="Self-Hosting Instructions",l={unversionedId:"nango-deploy/oss-instructions",id:"nango-deploy/oss-instructions",title:"Self-Hosting Instructions",description:"When self-hosting Nango, there is some configuration you need to take care of.",source:"@site/docs/nango-deploy/oss-instructions.md",sourceDirName:"nango-deploy",slug:"/nango-deploy/oss-instructions",permalink:"/nango-deploy/oss-instructions",draft:!1,editUrl:"https://github.com/nangohq/nango/tree/master/docs/docs/nango-deploy/oss-instructions.md",tags:[],version:"current",frontMatter:{},sidebar:"nango",previous:{title:"Nango Open Source",permalink:"/category/deploy-nango-sync-open-source"},next:{title:"Deploy Nango on your local machine",permalink:"/nango-deploy/local"}},s={},c=[{value:"CLI",id:"cli",level:2},{value:"Server URL &amp; Callback URL",id:"server-url--callback-url",level:2},{value:"Persistent storage",id:"persistent-storage",level:2},{value:"Securing your instance",id:"securing-your-instance",level:2},{value:"Updating your instance",id:"updating-your-instance",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"self-hosting-instructions"},"Self-Hosting Instructions"),(0,a.kt)("p",null,"When self-hosting Nango, there is some configuration you need to take care of."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Nango is a recent product and we are improving it fast."),(0,a.kt)("p",{parentName:"admonition"},"At this point you should expect frequent changes to Nango, some of them requiring manual intervention upon updating your instance (i.e. breaking changes). We will do our best to always document these changes and providing you with a path to mitigate them. If you do not want to deal with this constraint, we recommend that you use ",(0,a.kt)("a",{parentName:"p",href:"/cloud"},"Nango Cloud"),"."),(0,a.kt)("p",{parentName:"admonition"},"If you need help or have questions about self-hosting please feel free to reach out on our ",(0,a.kt)("a",{parentName:"p",href:"https://www.nango.dev/slack"},"Slack community"),".")),(0,a.kt)("h2",{id:"cli"},"CLI"),(0,a.kt)("p",null,"Let the CLI know where to query Nango by adding the ",(0,a.kt)("inlineCode",{parentName:"p"},"NANGO_HOSTPORT")," env variable to your local environment (",(0,a.kt)("inlineCode",{parentName:"p"},".bashrc")," or equivalent):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"export NANGO_HOSTPORT=<YOUR-INSTANCE-URL>\n")),(0,a.kt)("h2",{id:"server-url--callback-url"},"Server URL & Callback URL"),(0,a.kt)("p",null,"Add you instance url to the ",(0,a.kt)("inlineCode",{parentName:"p"},".env")," file at the root of the ",(0,a.kt)("inlineCode",{parentName:"p"},"nango")," folder (and restart the Docker container):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"NANGO_SERVER_URL=<INSTANCE-URL>\n")),(0,a.kt)("p",null,"The resulting callback URL for OAuth will be ",(0,a.kt)("inlineCode",{parentName:"p"},"<INSTANCE-URL>/oauth/callback"),"."),(0,a.kt)("h2",{id:"persistent-storage"},"Persistent storage"),(0,a.kt)("p",null,"By default, the database is bundled in the docker container with transient storage. This means that updating the Docker image causes configs/credentials loss. This is a no-go for production."),(0,a.kt)("p",null,"Connect Nango to an external Postgres DB that lives outside the docker setup to mitigate this."),(0,a.kt)("p",null,"To do so, replace the values of the following env variables in the ",(0,a.kt)("inlineCode",{parentName:"p"},".env")," file at the root of the ",(0,a.kt)("inlineCode",{parentName:"p"},"nango")," folder (and restart the container):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"NANGO_DB_USER=<REPLACE>\nNANGO_DB_PASSWORD=<REPLACE>\nNANGO_DB_HOST=<REPLACE>\nNANGO_DB_PORT=<REPLACE>\nNANGO_DB_NAME=<REPLACE>\nNANGO_DB_SSL=<REPLACE>\n")),(0,a.kt)("h2",{id:"securing-your-instance"},"Securing your instance"),(0,a.kt)("p",null,"You can secure your instance by adding the ",(0,a.kt)("inlineCode",{parentName:"p"},"NANGO_SECRET_KEY")," variable to the ",(0,a.kt)("inlineCode",{parentName:"p"},".env")," file at the root of the ",(0,a.kt)("inlineCode",{parentName:"p"},"nango")," folder (and restarting the Docker container)."),(0,a.kt)("p",null,"This will require ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Basic_access_authentication"},"Basic Auth")," for all sensitive requests, e.g.:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"curl '<INSTANCE-URL>/connection/<CONNECTION-ID>?provider_config_key=<CONFIG-KEY>' -u '<SECRET-KEY>:'\n")),(0,a.kt)("p",null,"\u2757\ufe0fNotice the ",(0,a.kt)("inlineCode",{parentName:"p"},":")," character appended after ",(0,a.kt)("inlineCode",{parentName:"p"},"<SECRET-KEY>"),"."),(0,a.kt)("p",null,"If you are using the Node SDK, when initializing the ",(0,a.kt)("inlineCode",{parentName:"p"},"Nango")," object, pass in the Secret key in the ",(0,a.kt)("inlineCode",{parentName:"p"},"secretKey")," parameter."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { Nango } from '@nangohq/node';\n\nlet nango = new Nango({ host: 'http://localhost:3003', secretKey: '<SECRET-KEY>' });\n")),(0,a.kt)("p",null,"You should also configure the CLI to authenticate with Nango. Add to your ",(0,a.kt)("inlineCode",{parentName:"p"},".bashrc")," (or equivalent):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"export NANGO_SECRET_KEY=<SECRET-KEY>\n")),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"The Frontend SDK does not need the Secret key to initiate OAuth flows.")),(0,a.kt)("h2",{id:"updating-your-instance"},"Updating your instance"),(0,a.kt)("p",null,"When self-hosting Nango, you will need to update your instance yourself to benefit from improvements and new API templates. It should be as simple as running:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose stop\ndocker-compose rm -f\ndocker-compose pull\ndocker-compose up -d\n")))}u.isMDXComponent=!0}}]);